---
phase: 05-gallery-data
plan: 02
type: execute
domain: astro
---

<objective>
Convert photos page to album index and create album detail pages.

Purpose: Transform the photo gallery from flat photo grid to album-based navigation with individual
album pages. Output: /photos shows album grid, /photos/[slug] shows photos within each album.
</objective>

<execution_context> ~/.claude/get-shit-done/workflows/execute-phase.md ./summary.md
~/.claude/get-shit-done/references/checkpoints.md </execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-gallery-data/05-01-SUMMARY.md
@src/content/config.ts
@src/pages/photos.astro
@src/pages/tags/[tag].astro

**Tech stack available:** Astro content collections, dynamic routing [...slug].astro pattern
**Established patterns:** Content collection pattern, 2-column grid layout, CDN base URL
**Constraining decisions:**

- Phase 4: 2-column grid layout established
- Phase 4: CDN_BASE = 'https://cdn.hbish.com'
- Phase 5-01: Collections schema with slug, title, description, coverPhoto

**Issues being addressed:** None </context>

<tasks>

<task type="auto">
  <name>Task 1: Convert /photos to album index page</name>
  <files>src/pages/photos.astro</files>
  <action>Replace the current photo grid with an album grid:
- Import both 'collections' and 'photos' collections
- Filter collections by draft !== true, sort by date descending
- For each collection, display cover photo image (using CDN_BASE + coverPhoto key)
- Show album title and description below cover image
- Link each album card to /photos/{collection.slug}
- Use same grid layout (grid-cols-1 sm:grid-cols-2 gap-4)
- Add "All Photos" link at top to view unfiltered photos (optional, or can be added later)

Preserve existing Container layout and section-title styling.</action> <verify>npm run build
succeeds, /photos page loads without errors</verify> <done>/photos displays album grid with cover
photos, titles, and links to album pages</done> </task>

<task type="auto">
  <name>Task 2: Create album detail page at /photos/[slug].astro</name>
  <files>src/pages/photos/[slug].astro</files>
  <action>Create dynamic route for album detail:
- Use getStaticPaths to generate paths for all collections (slug)
- In component: getCollection('photos') filtered by collection slug matching the route parameter
- Display album title and description at top (from collection entry)
- Show photo grid (2-column) for photos in this collection only
- Use CDN_BASE + photo.data.id for image sources
- Include "Back to Albums" link to /photos
- Handle empty collections with "No photos in this album yet" message
- Filter out draft photos

Reference src/pages/tags/[tag].astro for dynamic routing pattern if needed.</action> <verify>npm run
build succeeds, /photos/kapi-g7x2 (or valid slug) loads with filtered photos</verify> <done>Album
detail page shows collection metadata and filtered photo grid, back link works</done> </task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Album index at /photos and album detail pages at /photos/[slug]</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:4321/photos
    3. Verify: Album grid displays with cover images and titles
    4. Click: On an album (e.g., "kapi-g7x2")
    5. Verify: Album detail page shows only photos from that collection
    6. Verify: "Back to Albums" link returns to /photos
    7. Verify: No console errors, all images load from cdn.hbish.com
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] /photos displays album grid (not all photos)
- [ ] /photos/[slug] routes work for each collection
- [ ] Photos are filtered by collection correctly
- [ ] All images load from CDN
</verification>

<success_criteria>

- Album index page shows collections with cover photos
- Album detail pages filter photos by collection
- Navigation between index and detail pages works
- All images load from cdn.hbish.com
- Build passes with no errors
- Phase 5 complete </success_criteria>

<output>
After completion, create `.planning/phases/05-gallery-data/05-02-SUMMARY.md`:

# Phase 5 Plan 2: Album Pages Summary

**Photo gallery converted to album-based navigation with index and detail pages.**

## Accomplishments

- /photos converted to album index with cover photo grid
- /photos/[slug] created for album detail pages
- Photos filtered by collection on detail pages
- Navigation between index and detail works

## Files Created/Modified

- `src/pages/photos.astro` - Converted from photo grid to album grid
- `src/pages/photos/[slug].astro` - Created album detail page with dynamic routing

## Decisions Made

None (follows established routing patterns)

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 5 complete, ready for Phase 6: Gallery UI Components </output>
