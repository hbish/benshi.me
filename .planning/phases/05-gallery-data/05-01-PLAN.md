---
phase: 05-gallery-data
plan: 01
type: execute
domain: astro
---

<objective>
Add featured field to photos and create collections schema for album organization.

Purpose: Enable photo highlighting and group photos into albums for gallery navigation. Output:
Updated photo schema with featured field, new collections collection, sample collections data.
</objective>

<execution_context> ~/.claude/get-shit-done/workflows/execute-phase.md ./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-cloudflare-images/04-01-SUMMARY.md
@src/content/config.ts
@src/content/photos/kapi-g7x2-251205103942342.mdx

**Tech stack available:** @aws-sdk/client-s3@3.966.0, Astro content collections, Zod schemas
**Established patterns:** Content collection pattern, R2 object keys as photo IDs **Constraining
decisions:**

- Phase 4: Content collection pattern confirmed
- Phase 4: Photos stored with R2 object key as id field
- Phase 4: Custom domain cdn.hbish.com for CDN

**Issues being addressed:** None </context>

<tasks>

<task type="auto">
  <name>Task 1: Add featured field to photo schema</name>
  <files>src/content/config.ts</files>
  <action>Add `featured: z.boolean().default(false)` field to photoCollection schema. Place after the `draft` field. This enables highlighting specific photos for future display features.</action>
  <verify>npm run build succeeds without TypeScript errors</verify>
  <done>Photo schema includes featured field with default false</done>
</task>

<task type="auto">
  <name>Task 2: Create collections content collection schema</name>
  <files>src/content/config.ts</files>
  <action>Create a new `collectionCollection` (or `albumCollection`) with schema containing:
- slug: z.string() (unique identifier for URLs)
- title: z.string()
- description: z.string().optional()
- coverPhoto: z.string() (R2 object key for album cover image)
- date: z.string().or(z.date()).transform(val => new Date(val))
- tags: z.array(z.string()).optional()
- draft: z.boolean().default(false)

Add to exports in collections object. Use singular 'collection' naming to match Astro conventions
(collection name = 'collections', defineCollection variable can be collectionCollection).</action>
<verify>npm run build succeeds, TypeScript recognizes new collections collection</verify>
<done>Collections schema added to config, exported in collections object</done> </task>

<task type="auto">
  <name>Task 3: Create collections data directory and sample entries</name>
  <files>src/content/collections/*.mdx</files>
  <action>Create src/content/collections/ directory. Add 2-3 sample collection .mdx files based on existing photos:
- "kapi-g7x2" (for KAPI G7X2 camera photos)
- "portraits" (for PXL portrait photos)
- "sample" (general sample photos)

Each entry should have frontmatter with slug, title, description, coverPhoto (use an existing
photo's R2 key), and current date. Set draft: false.

Use existing photo R2 keys from src/content/photos/ for coverPhoto values (e.g.,
"photos/KAPI_G7X2_251205103942342.jpg").</action> <verify>ls src/content/collections/ shows .mdx
files, getCollection('collections') returns entries</verify> <done>Collections directory created
with 2-3 sample album entries</done> </task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Photo schema includes featured field
- [ ] Collections collection exists and is accessible via getCollection
- [ ] Sample collections created with valid coverPhoto references
</verification>

<success_criteria>

- Photo schema has featured field (default false)
- Collections collection defined with slug, title, description, coverPhoto, date, tags, draft
- Sample collections created in src/content/collections/
- Build passes with no TypeScript errors </success_criteria>

<output>
After completion, create `.planning/phases/05-gallery-data/05-01-SUMMARY.md`:

# Phase 5 Plan 1: Schema Updates Summary

**Featured field added to photos, collections schema created for album organization.**

## Accomplishments

- Photo schema updated with featured boolean field
- Collections content collection schema created
- Sample collections data file created (2-3 albums)

## Files Created/Modified

- `src/content/config.ts` - Added featured field to photos, created collections schema
- `src/content/collections/*.mdx` - Sample collection entries created

## Decisions Made

None (schema follows established patterns)

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 05-02-PLAN.md (Album Pages) </output>
