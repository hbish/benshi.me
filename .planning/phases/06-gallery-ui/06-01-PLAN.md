---
phase: 06-gallery-ui
plan: 01
type: execute
domain: astro
---

<objective>
Build responsive photo grid and tag filtering UI for gallery pages.

Purpose: Improve photo gallery layout with responsive columns and shareable tag filtering. Output:
3-column responsive grid with server-side tag filtering on /photos and /photos/[slug]. </objective>

<execution_context> ~/.claude/get-shit-done/workflows/execute-phase.md ./summary.md
~/.claude/get-shit-done/references/checkpoints.md </execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-gallery-data/05-02-SUMMARY.md
@src/pages/photos.astro
@tailwind.config.cjs

**Tech stack available:** Astro 5.1.3, Tailwind CSS 3.0.24, content collections **Established
patterns:** 2-column grid (grid-cols-1 sm:grid-cols-2), CDN_BASE, lazy loading **Constraining
decisions:**

- Phase 4: 2-column grid layout established
- Phase 4: CDN_BASE = 'https://cdn.hbish.com'
- Phase 5: Album structure with collections

**Frontend tech lead recommendations:**

- Use CSS Grid (not CSS columns) to preserve chronological ordering
- Server-side filtering with URL params for shareability/SEO
- Tag buttons as `<a>` links with aria-current for accessibility
- "All" filter button for clear UX

**Issues being addressed:** None </context>

<tasks>

<task type="auto">
  <name>Task 1: Convert /photos to 3-column responsive grid</name>
  <files>src/pages/photos.astro</files>
  <action>Update the photo grid layout:
- Change from `grid-cols-1 sm:grid-cols-2` to `grid-cols-1 sm:grid-cols-2 lg:grid-cols-3`
- This provides: 1 column mobile, 2 columns tablet, 3 columns desktop
- Preserve existing gap-4 spacing and rounded-lg styling
- Keep lazy loading with `loading="lazy"`
- Add `decoding="async"` to all img tags for performance

Note: Using CSS Grid instead of CSS columns to preserve left-to-right chronological ordering. Accept
gaps between items as trade-off.</action> <verify>npm run build succeeds, grid shows 3 columns on
desktop viewport</verify> <done>Grid uses responsive breakpoints (1/2/3 columns), decoding="async"
added</done> </task>

<task type="auto">
  <name>Task 2: Add server-side tag filtering with URL params</name>
  <files>src/pages/photos.astro</files>
  <action>Add server-side tag filtering:
- Import `new URL(Astro.request.url)` to read query params
- Extract `activeTag` from `url.searchParams.get('tag')`
- Filter photos: if activeTag exists, only show photos with that tag
- Extract all unique tags from published photos for the filter UI: `[...new Set(allPhotos.flatMap(p => p.data.tags || []))].sort()`
- Filtering happens server-side during build/request, no JavaScript required

Keep existing date sorting after filtering is applied.</action> <verify>Visit /photos?tag=sample
shows only photos with "sample" tag</verify> <done>Tag filtering works with URL params, all tags
extracted for UI</done> </task>

<task type="auto">
  <name>Task 3: Add tag pills UI with "All" option</name>
  <files>src/pages/photos.astro</files>
  <action>Add tag filter navigation UI above the photo grid:
- Create `<nav>` element with `aria-label="Filter photos by tag"`
- Flex container with `gap-2 flex-wrap` for responsive tag pills
- "All" button: links to `/photos`, has `aria-current="page"` when no tag selected, active styling
- Tag buttons: map through allTags, link to `/photos?tag={tag}`, `aria-current="page"` when active
- Styling: `px-3 py-1 rounded-full text-sm transition-colors` base classes
- Active state: use scoped `<style>` with `.active` class for `@apply bg-blue-600 text-white`
- Inactive state: gray/neutral background, dark text
- Position: between section-title and photo grid section

Also update empty state message to show "No photos tagged '{tag}' yet" when filter has no
results.</action> <verify>Tag pills display, clicking filters photos, active tag
highlighted</verify> <done>Tag filter UI with "All" option, aria-current for accessibility</done>
</task>

<task type="auto">
  <name>Task 4: Apply same patterns to album detail page</name>
  <files>src/pages/photos/[slug].astro</files>
  <action>Apply the same responsive grid and tag filtering to album detail page:
- Update grid to `grid-cols-1 sm:grid-cols-2 lg:grid-cols-3`
- Add same server-side tag filtering logic (read from URL params)
- Add same tag pills UI above the photo grid
- Filter photos within the album by tag (maintains album scope + tag filter)
- Keep "Back to Albums" link above filter UI
- Empty state: "No photos tagged '{tag}' in this album yet"

This maintains consistency between main gallery and album detail views.</action> <verify>Album
detail page has 3-column grid and tag filtering working within album scope</verify> <done>Album
detail page has consistent grid and filtering UI</done> </task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Responsive grid (1/2/3 columns) and tag filtering on /photos and /photos/[slug]</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:4321/photos
    3. Verify: 3-column grid on desktop (>1024px), 2 on tablet, 1 on mobile
    4. Verify: Tag pills display at top with "All" button
    5. Click: On a tag (e.g., "sample")
    6. Verify: URL changes to /photos?tag=sample, only tagged photos show
    7. Verify: Active tag has different styling (blue background)
    8. Click: "All" button
    9. Verify: All photos display again, URL is /photos
    10. Click: On an album to visit /photos/[slug]
    11. Verify: Album page has same grid and filtering within album scope
    12. Verify: No console errors
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Grid is responsive (1/2/3 columns based on viewport)
- [ ] Tag filtering works with URL params
- [ ] "All" button resets filter
- [ ] Active tag has visual indication and aria-current
- [ ] Both /photos and /photos/[slug] have consistent UI
- [ ] All images load from CDN
</verification>

<success_criteria>

- Responsive 3-column grid (1 mobile, 2 tablet, 3 desktop)
- Server-side tag filtering with shareable URLs
- Tag pills UI with "All" option and accessibility attributes
- Consistent UI across main gallery and album detail pages
- Phase 6 complete </success_criteria>

<output>
After completion, create `.planning/phases/06-gallery-ui/06-01-SUMMARY.md`:

# Phase 6 Plan 1: Gallery UI Components Summary

**Responsive photo grid and tag filtering UI added to gallery pages.**

## Accomplishments

- Upgraded to 3-column responsive grid (1/2/3 based on viewport)
- Added server-side tag filtering with URL params
- Created tag pills navigation with "All" option
- Applied consistent patterns to main gallery and album detail pages

## Files Created/Modified

- `src/pages/photos.astro` - Responsive grid, tag filtering, tag pills UI
- `src/pages/photos/[slug].astro` - Same patterns applied to album detail

## Decisions Made

- CSS Grid over CSS columns to preserve chronological ordering
- Server-side filtering with URL params for shareability/SEO
- Tag buttons as links with aria-current for accessibility

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 6 complete, ready for Phase 7: Gallery Integration (lazy loading, responsive images, lightbox)
</output>
