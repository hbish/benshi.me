---
import Container from '../layouts/Container.astro'
import { getCollection } from 'astro:content'

// Get a few random posts for suggestions
const posts = (await getCollection('posts'))
  .filter(p => !p.data.draft)
  .sort(() => Math.random() - 0.5)
  .slice(0, 3)

const notes = (await getCollection('notes'))
  .filter(n => !n.data.draft)
  .sort(() => Math.random() - 0.5)
  .slice(0, 2)
---

<Container title="Page Not Found - Ben Shi">
  <div class="section-title text-center text-3xl my-8 px-4 sm:px-0">404 - Page Not Found</div>

  <section class="text-center px-4 sm:px-0 max-w-2xl mx-auto">
    <div class="text-6xl mb-6">ü§î</div>

    <div class="mb-8">
      <p class="text-lg mb-4">
        Hmm, that page doesn't seem to exist. Maybe it moved, or perhaps you stumbled upon a broken
        link?
      </p>
    </div>

    <!-- Random Content Suggestions -->
    {
      (posts.length > 0 || notes.length > 0) && (
        <div class="text-left">
          <h3 class="text-xl font-semibold mb-4 text-center">Check out some random content:</h3>

          {posts.length > 0 && (
            <div class="mb-6">
              <h4 class="text-lg font-medium mb-3">üìñ Random Posts</h4>
              <div class="space-y-2">
                {posts.map(post => (
                  <div class="border-l-2 border-blue-300 dark:border-blue-600 pl-4">
                    <a
                      href={`/${post.slug}`}
                      class="text-blue-600 dark:text-blue-400 hover:underline font-medium"
                    >
                      {post.data.title}
                    </a>
                    <div class="text-sm text-gray-600 dark:text-gray-400">
                      {post.data.date.toLocaleDateString(undefined, {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric',
                      })}
                      {post.data.minutesRead && ` ‚Ä¢ ~${post.data.minutesRead} min read`}
                    </div>
                    {post.data.description && (
                      <div class="text-sm text-gray-700 dark:text-gray-300 mt-1">
                        {post.data.description}
                      </div>
                    )}
                  </div>
                ))}
              </div>
            </div>
          )}

          {notes.length > 0 && (
            <div>
              <h4 class="text-lg font-medium mb-3">üóíÔ∏è Quick Notes</h4>
              <div class="space-y-2">
                {notes.map(note => (
                  <div class="border-l-2 border-green-300 dark:border-green-600 pl-4">
                    <a
                      href={`/${note.slug}`}
                      class="text-green-600 dark:text-green-400 hover:underline font-medium"
                    >
                      {note.data.title}
                    </a>
                    <div class="text-sm text-gray-600 dark:text-gray-400">
                      {note.data.date.toLocaleDateString(undefined, {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric',
                      })}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}
        </div>
      )
    }
  </section>
</Container>
